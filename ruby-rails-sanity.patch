diff -ur rails-o/vendor/rails/railties/Rakefile rails/vendor/rails/railties/Rakefile
--- rails-o/vendor/rails/railties/Rakefile	2005-12-13 12:20:09.000000000 -0700
+++ rails/vendor/rails/railties/Rakefile	2006-03-07 17:39:11.000000000 -0700
@@ -1,7 +1,6 @@
 require 'rake'
 require 'rake/testtask'
 require 'rake/rdoctask'
-require 'rake/gempackagetask'
 require 'rake/contrib/rubyforgepublisher'
 
 require 'date'
@@ -45,9 +44,6 @@
 desc "Generates a fresh Rails package with documentation"
 task :fresh_rails => [ :clean, :make_dir_structure, :initialize_file_stubs, :copy_vendor_libraries, :copy_ties_content, :generate_documentation ]
 
-desc "Generates a fresh Rails package using GEMs with documentation"
-task :fresh_gem_rails => [ :clean, :make_dir_structure, :initialize_file_stubs, :copy_ties_content, :copy_gem_environment ]
-
 desc "Generates a fresh Rails package without documentation (faster)"
 task :fresh_rails_without_docs => [ :clean, :make_dir_structure, :initialize_file_stubs, :copy_vendor_libraries, :copy_ties_content ]
 
@@ -182,7 +178,6 @@
 task :copy_rootfiles do
   cp "fresh_rakefile", "#{PKG_DESTINATION}/Rakefile"
   cp "README", "#{PKG_DESTINATION}/README"
-  cp "CHANGELOG", "#{PKG_DESTINATION}/CHANGELOG"
 end
 
 task :copy_test_helpers do
@@ -240,183 +235,3 @@
   rdoc.rdoc_files.include('lib/rails_generator/*.rb')
   rdoc.rdoc_files.include('lib/commands/**/*.rb')
 }
-
-# Generate GEM ----------------------------------------------------------------------------
-
-task :copy_gem_environment do
-  cp "environments/environment.rb", "#{PKG_DESTINATION}/config/environment.rb"
-  chmod 0755, dest_file
-end
-
-
-PKG_FILES = FileList[
-  '[a-zA-Z]*',
-  'bin/**/*', 
-  'builtin/**/*',
-  'configs/**/*', 
-  'doc/**/*', 
-  'dispatches/**/*', 
-  'environments/**/*', 
-  'helpers/**/*', 
-  'generators/**/*', 
-  'html/**/*', 
-  'lib/**/*'
-]
-
-spec = Gem::Specification.new do |s|
-  s.name = 'rails'
-  s.version = PKG_VERSION
-  s.summary = "Web-application framework with template engine, control-flow layer, and ORM."
-  s.description = <<-EOF
-    Rails is a framework for building web-application using CGI, FCGI, mod_ruby, or WEBrick
-    on top of either MySQL, PostgreSQL, SQLite, DB2, SQL Server, or Oracle with eRuby- or Builder-based templates.
-  EOF
-
-  s.add_dependency('rake', '>= 0.6.2')
-  s.add_dependency('activesupport',    '= 1.2.5' + PKG_BUILD)
-  s.add_dependency('activerecord',     '= 1.13.2' + PKG_BUILD)
-  s.add_dependency('actionpack',       '= 1.11.2' + PKG_BUILD)
-  s.add_dependency('actionmailer',     '= 1.1.5' + PKG_BUILD)
-  s.add_dependency('actionwebservice', '= 1.0.0' + PKG_BUILD)
-
-  s.rdoc_options << '--exclude' << '.'
-  s.has_rdoc = false
-
-  s.files = PKG_FILES.to_a.delete_if {|f| f.include?('.svn')}
-  s.require_path = 'lib'
-
-  s.bindir = "bin"                               # Use these for applications.
-  s.executables = ["rails"]
-  s.default_executable = "rails"
-
-  s.author = "David Heinemeier Hansson"
-  s.email = "david@loudthinking.com"
-  s.homepage = "http://www.rubyonrails.org"
-  s.rubyforge_project = "rails"
-end
-
-Rake::GemPackageTask.new(spec) do |pkg|
-end
-
-
-# Publishing -------------------------------------------------------
-desc "Publish the API documentation"
-task :pgem => [:gem] do 
-  Rake::SshFilePublisher.new("davidhh@wrath.rubyonrails.org", "public_html/gems/gems", "pkg", "#{PKG_FILE_NAME}.gem").upload
-  `ssh davidhh@wrath.rubyonrails.org './gemupdate.sh'`
-end
-
-desc "Publish the release files to RubyForge."
-task :release => [:gem] do
-  files = ["gem"].map { |ext| "pkg/#{PKG_FILE_NAME}.#{ext}" }
-
-  if RUBY_FORGE_PROJECT then
-    require 'net/http'
-    require 'open-uri'
-
-    project_uri = "http://rubyforge.org/projects/#{RUBY_FORGE_PROJECT}/"
-    project_data = open(project_uri) { |data| data.read }
-    group_id = project_data[/[?&]group_id=(\d+)/, 1]
-    raise "Couldn't get group id" unless group_id
-
-    # This echos password to shell which is a bit sucky
-    if ENV["RUBY_FORGE_PASSWORD"]
-      password = ENV["RUBY_FORGE_PASSWORD"]
-    else
-      print "#{RUBY_FORGE_USER}@rubyforge.org's password: "
-      password = STDIN.gets.chomp
-    end
-
-    login_response = Net::HTTP.start("rubyforge.org", 80) do |http|
-      data = [
-        "login=1",
-        "form_loginname=#{RUBY_FORGE_USER}",
-        "form_pw=#{password}"
-      ].join("&")
-      http.post("/account/login.php", data)
-    end
-
-    cookie = login_response["set-cookie"]
-    raise "Login failed" unless cookie
-    headers = { "Cookie" => cookie }
-
-    release_uri = "http://rubyforge.org/frs/admin/?group_id=#{group_id}"
-    release_data = open(release_uri, headers) { |data| data.read }
-    package_id = release_data[/[?&]package_id=(\d+)/, 1]
-    raise "Couldn't get package id" unless package_id
-
-    first_file = true
-    release_id = ""
-
-    files.each do |filename|
-      basename  = File.basename(filename)
-      file_ext  = File.extname(filename)
-      file_data = File.open(filename, "rb") { |file| file.read }
-
-      puts "Releasing #{basename}..."
-
-      release_response = Net::HTTP.start("rubyforge.org", 80) do |http|
-        release_date = Time.now.strftime("%Y-%m-%d %H:%M")
-        type_map = {
-          ".zip"    => "3000",
-          ".tgz"    => "3110",
-          ".gz"     => "3110",
-          ".gem"    => "1400"
-        }; type_map.default = "9999"
-        type = type_map[file_ext]
-        boundary = "rubyqMY6QN9bp6e4kS21H4y0zxcvoor"
-
-        query_hash = if first_file then
-          {
-            "group_id" => group_id,
-            "package_id" => package_id,
-            "release_name" => RELEASE_NAME,
-            "release_date" => release_date,
-            "type_id" => type,
-            "processor_id" => "8000", # Any
-            "release_notes" => "",
-            "release_changes" => "",
-            "preformatted" => "1",
-            "submit" => "1"
-          }
-        else
-          {
-            "group_id" => group_id,
-            "release_id" => release_id,
-            "package_id" => package_id,
-            "step2" => "1",
-            "type_id" => type,
-            "processor_id" => "8000", # Any
-            "submit" => "Add This File"
-          }
-        end
-
-        query = "?" + query_hash.map do |(name, value)|
-          [name, URI.encode(value)].join("=")
-        end.join("&")
-
-        data = [
-          "--" + boundary,
-          "Content-Disposition: form-data; name=\"userfile\"; filename=\"#{basename}\"",
-          "Content-Type: application/octet-stream",
-          "Content-Transfer-Encoding: binary",
-          "", file_data, ""
-          ].join("\x0D\x0A")
-
-        release_headers = headers.merge(
-          "Content-Type" => "multipart/form-data; boundary=#{boundary}"
-        )
-
-        target = first_file ? "/frs/admin/qrs.php" : "/frs/admin/editrelease.php"
-        http.post(target + query, data, release_headers)
-      end
-
-      if first_file then
-        release_id = release_response.body[/release_id=(\d+)/, 1]
-        raise("Couldn't get release id") unless release_id
-      end
-
-      first_file = false
-    end
-  end
-end
Only in rails/vendor/rails/railties: Rakefile.rej~
Only in rails/vendor/rails/railties: Rakefile~
diff -ur rails-o/vendor/rails/railties/bin/rails rails/vendor/rails/railties/bin/rails
--- rails-o/vendor/rails/railties/bin/rails	2005-12-13 12:20:09.000000000 -0700
+++ rails/vendor/rails/railties/bin/rails	2006-03-07 17:34:24.000000000 -0700
@@ -1,3 +1,4 @@
+#!/usr/bin/ruby
 min_release  = "1.8.2 (2004-12-25)"
 ruby_release = "#{RUBY_VERSION} (#{RUBY_RELEASE_DATE})"
 if ruby_release < min_release
diff -ur rails-o/vendor/rails/railties/dispatches/dispatch.fcgi rails/vendor/rails/railties/dispatches/dispatch.fcgi
--- rails-o/vendor/rails/railties/dispatches/dispatch.fcgi	2005-12-13 12:20:09.000000000 -0700
+++ rails/vendor/rails/railties/dispatches/dispatch.fcgi	2006-03-07 17:34:24.000000000 -0700
@@ -1,4 +1,4 @@
-#!/usr/local/bin/ruby
+#!/usr/bin/ruby
 #
 # You may specify the path to the FastCGI crash log (a log of unhandled
 # exceptions which forced the FastCGI instance to exit, great for debugging)
@@ -19,6 +19,6 @@
 #   RailsFCGIHandler.process! '/var/log/myapp_fcgi_crash.log'
 #
 require File.dirname(__FILE__) + "/../config/environment"
-require 'fcgi_handler'
+require 'railties/fcgi_handler'
 
 RailsFCGIHandler.process!
diff -ur rails-o/vendor/rails/railties/dispatches/dispatch.rb rails/vendor/rails/railties/dispatches/dispatch.rb
--- rails-o/vendor/rails/railties/dispatches/dispatch.rb	2005-12-13 12:20:09.000000000 -0700
+++ rails/vendor/rails/railties/dispatches/dispatch.rb	2006-03-07 17:34:24.000000000 -0700
@@ -1,10 +1,8 @@
-#!/usr/local/bin/ruby
+#!/usr/bin/ruby
 
 require File.dirname(__FILE__) + "/../config/environment" unless defined?(RAILS_ROOT)
 
-# If you're using RubyGems and mod_ruby, this require should be changed to an absolute path one, like:
-# "/usr/local/lib/ruby/gems/1.8/gems/rails-0.8.0/lib/dispatcher" -- otherwise performance is severely impaired
-require "dispatcher"
+require "railties/dispatcher"
 
 ADDITIONAL_LOAD_PATHS.reverse.each { |dir| $:.unshift(dir) if File.directory?(dir) } if defined?(Apache::RubyRun)
-Dispatcher.dispatch
\ No newline at end of file
+Dispatcher.dispatch
diff -ur rails-o/vendor/rails/railties/lib/rails_generator/generators/applications/app/USAGE rails/vendor/rails/railties/lib/rails_generator/generators/applications/app/USAGE
--- rails-o/vendor/rails/railties/lib/rails_generator/generators/applications/app/USAGE	2005-12-13 12:20:09.000000000 -0700
+++ rails/vendor/rails/railties/lib/rails_generator/generators/applications/app/USAGE	2006-03-07 17:34:24.000000000 -0700
@@ -7,10 +7,3 @@
 
     This generates a skeletal Rails installation in ~/Code/Ruby/weblog.
     See the README in the newly created application to get going.
-
-WARNING:
-    Only specify --without-gems if you did not use gems to install Rails.
-    Your application will expect to find activerecord, actionpack, and
-    actionmailer directories in the vendor directory.  A popular way to track
-    the bleeding edge of Rails development is to checkout from source control
-    directly to the vendor directory.  See http://dev.rubyonrails.com
diff -ur rails-o/vendor/rails/railties/lib/rails_generator/generators/applications/app/app_generator.rb rails/vendor/rails/railties/lib/rails_generator/generators/applications/app/app_generator.rb
--- rails-o/vendor/rails/railties/lib/rails_generator/generators/applications/app/app_generator.rb	2005-12-13 12:20:09.000000000 -0700
+++ rails/vendor/rails/railties/lib/rails_generator/generators/applications/app/app_generator.rb	2006-03-07 17:36:45.000000000 -0700
@@ -4,7 +4,7 @@
   DEFAULT_SHEBANG = File.join(Config::CONFIG['bindir'],
                               Config::CONFIG['ruby_install_name'])
   
-  default_options   :gem => true, :shebang => DEFAULT_SHEBANG
+  default_options   :gem => false, :shebang => DEFAULT_SHEBANG
   mandatory_options :source  => "#{File.dirname(__FILE__)}/../../../../.."
 
   def initialize(runtime_args, runtime_options = {})
@@ -18,6 +18,7 @@
   def manifest
     script_options     = { :chmod => 0755 }
     dispatcher_options = { :chmod => 0755, :shebang => options[:shebang] }
+		@source_root = '/usr/share/rails'
 
     record do |m|
       # Root directory and all subdirectories.
@@ -93,9 +94,6 @@
       opt.separator 'Options:'
       opt.on("--ruby [#{DEFAULT_SHEBANG}]",
              "Path to the Ruby binary of your choice.") { |options[:shebang]| }
-      opt.on("--without-gems",
-             "Don't use the Rails gems for your app.",
-             "WARNING: see note below.") { |options[:gem]| }
     end
 
 
Only in rails/vendor/rails/railties/lib/rails_generator/generators/applications/app: app_generator.rb~
diff -ur rails-o/vendor/rails/railties/lib/rails_generator/lookup.rb rails/vendor/rails/railties/lib/rails_generator/lookup.rb
--- rails-o/vendor/rails/railties/lib/rails_generator/lookup.rb	2005-12-13 12:20:09.000000000 -0700
+++ rails/vendor/rails/railties/lib/rails_generator/lookup.rb	2006-03-07 17:34:24.000000000 -0700
@@ -94,8 +94,7 @@
         #     generating in the context of a Rails application, so search
         #     RAILS_ROOT/generators.
         # 2.  User home directory.  Search ~/.rails/generators.
-        # 3.  RubyGems.  Search for gems named *_generator.
-        # 4.  Builtins.  Model, controller, mailer, scaffold.
+        # 3.  Builtins.  Model, controller, mailer, scaffold.
         def use_component_sources!
           reset_sources
           if defined? ::RAILS_ROOT
@@ -185,26 +184,5 @@
         end
       end
     end
-
-
-    # GemSource hits the mines to quarry for generators.  The latest versions
-    # of gems named *_generator are selected.
-    class GemSource < Source
-      def initialize
-        super :RubyGems
-      end
-
-      # Yield latest versions of generator gems.
-      def each
-        Gem::cache.search(/_generator$/).inject({}) { |latest, gem|
-          hem = latest[gem.name]
-          latest[gem.name] = gem if hem.nil? or gem.version > hem.version
-          latest
-        }.values.each { |gem|
-          yield Spec.new(gem.name.sub(/_generator$/, ''), gem.full_gem_path, label)
-        }
-      end
-    end
-
   end
 end
diff -ur rails-o/vendor/rails/railties/lib/rails_generator/scripts.rb rails/vendor/rails/railties/lib/rails_generator/scripts.rb
--- rails-o/vendor/rails/railties/lib/rails_generator/scripts.rb	2005-12-13 12:20:09.000000000 -0700
+++ rails/vendor/rails/railties/lib/rails_generator/scripts.rb	2006-03-07 17:37:43.000000000 -0700
@@ -68,11 +68,6 @@
   3. Run generate with no arguments for usage information
        #{$0} login
 
-Generator gems are also available:
-  1. gem search -r generator
-  2. gem install login_generator
-  3. #{$0} login
-
 end_blurb
             return usage
           end
Only in rails/vendor/rails/railties/lib/rails_generator: scripts.rb.rej~
Only in rails/vendor/rails/railties/lib/rails_generator: scripts.rb~
diff -ur rails-o/vendor/rails/railties/lib/rails_generator.rb rails/vendor/rails/railties/lib/rails_generator.rb
--- rails-o/vendor/rails/railties/lib/rails_generator.rb	2005-12-13 12:20:09.000000000 -0700
+++ rails/vendor/rails/railties/lib/rails_generator.rb	2006-03-07 17:34:24.000000000 -0700
@@ -24,12 +24,7 @@
 $:.unshift(File.dirname(__FILE__))
 $:.unshift(File.dirname(__FILE__) + "/../../activesupport/lib")
 
-begin
-  require 'active_support'  
-rescue LoadError
-  require 'rubygems'
-  require_gem 'activesupport'
-end
+require 'active_support'  
 
 require 'rails_generator/base'
 require 'rails_generator/lookup'
diff -ur rails-o/vendor/rails/railties/bin/rails rails/vendor/rails/railties/bin/rails
--- rails-o/vendor/rails/railties/bin/rails	2006-03-07 17:53:45.000000000 -0700
+++ rails/vendor/rails/railties/bin/rails	2006-03-07 17:57:07.000000000 -0700
@@ -12,11 +12,11 @@
 
 Signal.trap("INT") { puts; exit }
 
-require File.dirname(__FILE__) + '/../lib/rails_version'
+require 'railties/rails_version'
 abort "Rails #{Rails::VERSION::STRING}" if %w(--version -v).include? ARGV.first
 
-require File.dirname(__FILE__) + '/../lib/rails_generator'
+require 'railties/rails_generator'
 
-require 'rails_generator/scripts/generate'
+require 'railties/rails_generator/scripts/generate'
 Rails::Generator::Base.use_application_sources!
 Rails::Generator::Scripts::Generate.new.run(ARGV, :generator => 'app')
diff -ur rails-o/vendor/rails/railties/lib/rails_info.rb rails/vendor/rails/railties/lib/rails_info.rb
--- rails-o/vendor/rails/railties/lib/rails_info.rb	2005-12-13 12:20:09.000000000 -0700
+++ rails/vendor/rails/railties/lib/rails_info.rb	2006-03-07 17:57:31.000000000 -0700
@@ -1,4 +1,4 @@
-require 'rails_version'
+require 'railties/rails_version'
 
 module Rails
   module Info
diff -ur rails-o/vendor/rails/railties/bin/about rails/vendor/rails/railties/bin/about
--- rails-o/vendor/rails/railties/bin/about	2005-12-13 12:20:09.000000000 -0700
+++ rails/vendor/rails/railties/bin/about	2006-03-07 18:15:00.000000000 -0700
@@ -1,3 +1,3 @@
 #!/usr/bin/env ruby
 require File.dirname(__FILE__) + '/../config/boot'
-require 'commands/about'
\ No newline at end of file
+require 'railties/commands/about'
diff -ur rails-o/vendor/rails/railties/bin/breakpointer rails/vendor/rails/railties/bin/breakpointer
--- rails-o/vendor/rails/railties/bin/breakpointer	2005-12-13 12:20:09.000000000 -0700
+++ rails/vendor/rails/railties/bin/breakpointer	2006-03-07 18:15:06.000000000 -0700
@@ -1,3 +1,3 @@
 #!/usr/bin/env ruby
 require File.dirname(__FILE__) + '/../config/boot'
-require 'commands/breakpointer'
\ No newline at end of file
+require 'railties/commands/breakpointer'
diff -ur rails-o/vendor/rails/railties/bin/console rails/vendor/rails/railties/bin/console
--- rails-o/vendor/rails/railties/bin/console	2005-12-13 12:20:09.000000000 -0700
+++ rails/vendor/rails/railties/bin/console	2006-03-07 18:15:13.000000000 -0700
@@ -1,3 +1,3 @@
 #!/usr/bin/env ruby
 require File.dirname(__FILE__) + '/../config/boot'
-require 'commands/console'
\ No newline at end of file
+require 'railties/commands/console'
diff -ur rails-o/vendor/rails/railties/bin/destroy rails/vendor/rails/railties/bin/destroy
--- rails-o/vendor/rails/railties/bin/destroy	2005-12-13 12:20:09.000000000 -0700
+++ rails/vendor/rails/railties/bin/destroy	2006-03-07 18:15:19.000000000 -0700
@@ -1,3 +1,3 @@
 #!/usr/bin/env ruby
 require File.dirname(__FILE__) + '/../config/boot'
-require 'commands/destroy'
\ No newline at end of file
+require 'railties/commands/destroy'
diff -ur rails-o/vendor/rails/railties/bin/generate rails/vendor/rails/railties/bin/generate
--- rails-o/vendor/rails/railties/bin/generate	2005-12-13 12:20:09.000000000 -0700
+++ rails/vendor/rails/railties/bin/generate	2006-03-07 18:15:23.000000000 -0700
@@ -1,3 +1,3 @@
 #!/usr/bin/env ruby
 require File.dirname(__FILE__) + '/../config/boot'
-require 'commands/generate'
\ No newline at end of file
+require 'railties/commands/generate'
diff -ur rails-o/vendor/rails/railties/bin/performance/benchmarker rails/vendor/rails/railties/bin/performance/benchmarker
--- rails-o/vendor/rails/railties/bin/performance/benchmarker	2005-12-13 12:20:09.000000000 -0700
+++ rails/vendor/rails/railties/bin/performance/benchmarker	2006-03-07 18:16:13.000000000 -0700
@@ -1,3 +1,3 @@
 #!/usr/bin/env ruby
 require File.dirname(__FILE__) + '/../../config/boot'
-require 'commands/performance/benchmarker'
+require 'railties/commands/performance/benchmarker'
diff -ur rails-o/vendor/rails/railties/bin/performance/profiler rails/vendor/rails/railties/bin/performance/profiler
--- rails-o/vendor/rails/railties/bin/performance/profiler	2005-12-13 12:20:09.000000000 -0700
+++ rails/vendor/rails/railties/bin/performance/profiler	2006-03-07 18:16:18.000000000 -0700
@@ -1,3 +1,3 @@
 #!/usr/bin/env ruby
 require File.dirname(__FILE__) + '/../../config/boot'
-require 'commands/performance/profiler'
+require 'railties/commands/performance/profiler'
diff -ur rails-o/vendor/rails/railties/bin/plugin rails/vendor/rails/railties/bin/plugin
--- rails-o/vendor/rails/railties/bin/plugin	2005-12-13 12:20:09.000000000 -0700
+++ rails/vendor/rails/railties/bin/plugin	2006-03-07 18:15:30.000000000 -0700
@@ -1,3 +1,3 @@
 #!/usr/bin/env ruby
 require File.dirname(__FILE__) + '/../config/boot'
-require 'commands/plugin'
\ No newline at end of file
+require 'railties/commands/plugin'
diff -ur rails-o/vendor/rails/railties/bin/process/reaper rails/vendor/rails/railties/bin/process/reaper
--- rails-o/vendor/rails/railties/bin/process/reaper	2005-12-13 12:20:09.000000000 -0700
+++ rails/vendor/rails/railties/bin/process/reaper	2006-03-07 18:16:23.000000000 -0700
@@ -1,3 +1,3 @@
 #!/usr/bin/env ruby
 require File.dirname(__FILE__) + '/../../config/boot'
-require 'commands/process/reaper'
+require 'railties/commands/process/reaper'
diff -ur rails-o/vendor/rails/railties/bin/process/spawner rails/vendor/rails/railties/bin/process/spawner
--- rails-o/vendor/rails/railties/bin/process/spawner	2005-12-13 12:20:09.000000000 -0700
+++ rails/vendor/rails/railties/bin/process/spawner	2006-03-07 18:16:29.000000000 -0700
@@ -1,3 +1,3 @@
 #!/usr/bin/env ruby
 require File.dirname(__FILE__) + '/../../config/boot'
-require 'commands/process/spawner'
+require 'railties/commands/process/spawner'
diff -ur rails-o/vendor/rails/railties/bin/process/spinner rails/vendor/rails/railties/bin/process/spinner
--- rails-o/vendor/rails/railties/bin/process/spinner	2005-12-13 12:20:09.000000000 -0700
+++ rails/vendor/rails/railties/bin/process/spinner	2006-03-07 18:16:37.000000000 -0700
@@ -1,3 +1,3 @@
 #!/usr/bin/env ruby
 require File.dirname(__FILE__) + '/../../config/boot'
-require 'commands/process/spinner'
+require 'railties/commands/process/spinner'
diff -ur rails-o/vendor/rails/railties/bin/runner rails/vendor/rails/railties/bin/runner
--- rails-o/vendor/rails/railties/bin/runner	2005-12-13 12:20:09.000000000 -0700
+++ rails/vendor/rails/railties/bin/runner	2006-03-07 18:15:49.000000000 -0700
@@ -1,3 +1,3 @@
 #!/usr/bin/env ruby
 require File.dirname(__FILE__) + '/../config/boot'
-require 'commands/runner'
\ No newline at end of file
+require 'railties/commands/runner'
diff -ur rails-o/vendor/rails/railties/bin/server rails/vendor/rails/railties/bin/server
--- rails-o/vendor/rails/railties/bin/server	2005-12-13 12:20:09.000000000 -0700
+++ rails/vendor/rails/railties/bin/server	2006-03-07 18:15:55.000000000 -0700
@@ -1,3 +1,3 @@
 #!/usr/bin/env ruby
 require File.dirname(__FILE__) + '/../config/boot'
-require 'commands/server'
\ No newline at end of file
+require 'railties/commands/server'
diff -ur rails-o/vendor/rails/railties/environments/boot.rb rails/vendor/rails/railties/environments/boot.rb
--- rails-o/vendor/rails/railties/environments/boot.rb	2005-12-13 12:20:09.000000000 -0700
+++ rails/vendor/rails/railties/environments/boot.rb	2006-03-07 18:18:10.000000000 -0700
@@ -12,8 +12,7 @@
 if File.directory?("#{RAILS_ROOT}/vendor/rails")
   require "#{RAILS_ROOT}/vendor/rails/railties/lib/initializer"
 else
-  require 'rubygems'
-  require 'initializer'
+  require 'railties/initializer'
 end
 
 Rails::Initializer.run(:set_load_path)
diff -ur rails-o/vendor/rails/railties/lib/commands/about.rb rails/vendor/rails/railties/lib/commands/about.rb
--- rails-o/vendor/rails/railties/lib/commands/about.rb	2005-12-13 12:20:09.000000000 -0700
+++ rails/vendor/rails/railties/lib/commands/about.rb	2006-03-07 18:30:28.000000000 -0700
@@ -1,2 +1,2 @@
-require 'environment'
+require "#{RAILS_ROOT}/config/environment"
 puts Rails::Info
diff -ur rails-o/vendor/rails/railties/lib/commands/breakpointer.rb rails/vendor/rails/railties/lib/commands/breakpointer.rb
--- rails-o/vendor/rails/railties/lib/commands/breakpointer.rb	2005-12-13 12:20:09.000000000 -0700
+++ rails/vendor/rails/railties/lib/commands/breakpointer.rb	2006-03-07 18:31:00.000000000 -0700
@@ -1 +1 @@
-require 'breakpoint_client'
+require 'railties/breakpoint_client'
diff -ur rails-o/vendor/rails/railties/lib/commands/destroy.rb rails/vendor/rails/railties/lib/commands/destroy.rb
--- rails-o/vendor/rails/railties/lib/commands/destroy.rb	2005-12-13 12:20:09.000000000 -0700
+++ rails/vendor/rails/railties/lib/commands/destroy.rb	2006-03-07 18:20:04.000000000 -0700
@@ -1,6 +1,6 @@
 require "#{RAILS_ROOT}/config/environment"
-require 'rails_generator'
-require 'rails_generator/scripts/destroy'
+require 'railties/rails_generator'
+require 'railties/rails_generator/scripts/destroy'
 
 ARGV.shift if ['--help', '-h'].include?(ARGV[0])
 Rails::Generator::Scripts::Destroy.new.run(ARGV)
diff -ur rails-o/vendor/rails/railties/lib/commands/generate.rb rails/vendor/rails/railties/lib/commands/generate.rb
--- rails-o/vendor/rails/railties/lib/commands/generate.rb	2005-12-13 12:20:09.000000000 -0700
+++ rails/vendor/rails/railties/lib/commands/generate.rb	2006-03-07 18:20:20.000000000 -0700
@@ -1,6 +1,6 @@
 require "#{RAILS_ROOT}/config/environment"
-require 'rails_generator'
-require 'rails_generator/scripts/generate'
+require 'railties/rails_generator'
+require 'railties/rails_generator/scripts/generate'
 
 ARGV.shift if ['--help', '-h'].include?(ARGV[0])
 Rails::Generator::Scripts::Generate.new.run(ARGV)
diff -ur rails-o/vendor/rails/railties/lib/commands/ncgi/listener rails/vendor/rails/railties/lib/commands/ncgi/listener
--- rails-o/vendor/rails/railties/lib/commands/ncgi/listener	2005-12-13 12:20:09.000000000 -0700
+++ rails/vendor/rails/railties/lib/commands/ncgi/listener	2006-03-07 18:21:38.000000000 -0700
@@ -2,7 +2,7 @@
 
 require 'stringio'
 require 'fileutils'
-require 'fcgi_handler'
+require 'railties/fcgi_handler'
 
 def message(s)
   $stderr.puts "listener: #{s}" if ENV && ENV["DEBUG_GATEWAY"]
@@ -83,4 +83,4 @@
 socket_path = ARGV.shift
 timeout = (ARGV.shift || 90).to_i
 
-Listener.new(timeout, socket_path)
\ No newline at end of file
+Listener.new(timeout, socket_path)
diff -ur rails-o/vendor/rails/railties/lib/commands/server.rb rails/vendor/rails/railties/lib/commands/server.rb
--- rails-o/vendor/rails/railties/lib/commands/server.rb	2005-12-13 12:20:09.000000000 -0700
+++ rails/vendor/rails/railties/lib/commands/server.rb	2006-03-07 18:32:25.000000000 -0700
@@ -1,7 +1,7 @@
 require 'active_support'
 
 begin
-  require_library_or_gem 'fcgi'
+  require 'fcgi'
 rescue Exception
   # FCGI not available
 end
@@ -25,4 +25,4 @@
   puts "=> Booting lighttpd (use 'script/server webrick' to force WEBrick)"
 end
 
-require "commands/servers/#{server}"
\ No newline at end of file
+require "railties/commands/servers/#{server}"
diff -ur rails-o/vendor/rails/railties/lib/commands/servers/lighttpd.rb rails/vendor/rails/railties/lib/commands/servers/lighttpd.rb
--- rails-o/vendor/rails/railties/lib/commands/servers/lighttpd.rb	2005-12-13 12:20:09.000000000 -0700
+++ rails/vendor/rails/railties/lib/commands/servers/lighttpd.rb	2006-03-07 18:22:22.000000000 -0700
@@ -8,7 +8,7 @@
   exit 1
 end
 
-require 'initializer'
+require 'railties/initializer'
 configuration = Rails::Initializer.run(:initialize_logger).configuration
 
 config_file = "#{RAILS_ROOT}/config/lighttpd.conf"
diff -ur rails-o/vendor/rails/railties/lib/commands/servers/webrick.rb rails/vendor/rails/railties/lib/commands/servers/webrick.rb
--- rails-o/vendor/rails/railties/lib/commands/servers/webrick.rb	2005-12-13 12:20:09.000000000 -0700
+++ rails/vendor/rails/railties/lib/commands/servers/webrick.rb	2006-03-07 18:22:35.000000000 -0700
@@ -50,7 +50,7 @@
 RAILS_ENV.replace(OPTIONS[:environment]) if defined?(RAILS_ENV)
 
 require RAILS_ROOT + "/config/environment"
-require 'webrick_server'
+require 'railties/webrick_server'
 
 OPTIONS['working_directory'] = File.expand_path(RAILS_ROOT)
 
diff -ur rails-o/vendor/rails/railties/lib/commands/update.rb rails/vendor/rails/railties/lib/commands/update.rb
--- rails-o/vendor/rails/railties/lib/commands/update.rb	2005-12-13 12:20:09.000000000 -0700
+++ rails/vendor/rails/railties/lib/commands/update.rb	2006-03-07 18:21:10.000000000 -0700
@@ -1,4 +1,4 @@
 require "#{RAILS_ROOT}/config/environment"
-require 'rails_generator'
-require 'rails_generator/scripts/update'
+require 'railties/rails_generator'
+require 'railties/rails_generator/scripts/update'
 Rails::Generator::Scripts::Update.new.run(ARGV)
diff -ur rails-o/vendor/rails/railties/lib/rails_generator.rb rails/vendor/rails/railties/lib/rails_generator.rb
--- rails-o/vendor/rails/railties/lib/rails_generator.rb	2006-03-07 18:13:23.000000000 -0700
+++ rails/vendor/rails/railties/lib/rails_generator.rb	2006-03-07 18:37:22.000000000 -0700
@@ -21,18 +21,15 @@
 # WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 #++
 
-$:.unshift(File.dirname(__FILE__))
-$:.unshift(File.dirname(__FILE__) + "/../../activesupport/lib")
-
 require 'active_support'  
 
-require 'rails_generator/base'
-require 'rails_generator/lookup'
-require 'rails_generator/commands'
+require 'railties/rails_generator/base'
+require 'railties/rails_generator/lookup'
+require 'railties/rails_generator/commands'
 
 Rails::Generator::Base.send(:include, Rails::Generator::Lookup)
 Rails::Generator::Base.send(:include, Rails::Generator::Commands)
 
 # Set up a default logger for convenience.
-require 'rails_generator/simple_logger'
+require 'railties/rails_generator/simple_logger'
 Rails::Generator::Base.logger = Rails::Generator::SimpleLogger.new(STDOUT)
diff -ur rails-o/vendor/rails/railties/lib/tasks/framework.rake rails/vendor/rails/railties/lib/tasks/framework.rake
--- rails-o/vendor/rails/railties/lib/tasks/framework.rake	2005-12-13 12:20:09.000000000 -0700
+++ rails/vendor/rails/railties/lib/tasks/framework.rake	2006-03-07 18:42:08.000000000 -0700
@@ -1,56 +1,3 @@
-desc "Lock this application to the current gems (by unpacking them into vendor/rails)"
-task :freeze_gems do
-  deps = %w(actionpack activerecord actionmailer activesupport actionwebservice)
-  require 'rubygems'
-
-  rails = if version = ENV['VERSION']
-            Gem.cache.search('rails', "= #{version}").first
-          else
-            Gem.cache.search('rails').sort_by { |g| g.version }.last
-          end
-  version ||= rails.version
-
-  unless rails
-    puts "No rails gem #{version} is installed.  Do 'gem list rails' to see what you have available."
-    exit
-  end
-
-  puts "Freezing to the gems for Rails #{rails.version}"
-  rm_rf   "vendor/rails"
-  mkdir_p "vendor/rails"
-
-  rails.dependencies.select { |g| deps.include? g.name }.each do |g|
-    system "cd vendor/rails; gem unpack -v '#{g.version_requirements}' #{g.name}; mv #{g.name}* #{g.name}"
-  end
-  system "cd vendor/rails; gem unpack -v '=#{version}' rails"
-  
-  FileUtils.mv(Dir.glob("vendor/rails/rails*").first, "vendor/rails/railties")
-end
-
-desc "Lock this application to the Edge Rails (by exporting from Subversion).  Defaults to svn HEAD; do 'rake freeze_edge REVISION=1234' to lock to a specific revision."
-task :freeze_edge do
-  $verbose = false
-  `svn --version` rescue nil
-  unless !$?.nil? && $?.success?
-    $stderr.puts "ERROR: Must have subversion (svn) available in the PATH to lock this application to Edge Rails"
-    exit 1
-  end
-
-  rm_rf   "vendor/rails"
-  mkdir_p "vendor/rails"
-
-  revision_switch = ENV['REVISION'] ? " -r #{ENV['REVISION']}" : ''
-  for framework in %w( railties actionpack activerecord actionmailer activesupport actionwebservice )
-    mkdir_p "vendor/rails/#{framework}"
-    system  "svn export http://dev.rubyonrails.org/svn/rails/trunk/#{framework}/lib vendor/rails/#{framework}/lib #{revision_switch}"
-  end
-end
-
-desc "Unlock this application from freeze of gems or edge and return to a fluid use of system gems"
-task :unfreeze_rails do
-  rm_rf "vendor/rails"
-end
-
 desc "Add new scripts to the application script/ directory"
 task :add_new_scripts do
   local_base = "script"
